<div class="container mt-4">
  <h3 class="page-title">Employee Management</h3>

  <div class="card p-4 mb-4">
    <form #empForm="ngForm" (ngSubmit)="addEmployee(empForm)">
      <div class="row g-3">
        <div class="col-md-3">
          <input
            type="text"
            class="form-control"
            placeholder="Employee ID"
            [(ngModel)]="form.employee_id"
            name="employee_id"
            #employeeId="ngModel"
            required
            pattern="^[0-9]+$"
          />
          @if (employeeId.invalid && employeeId.touched) {
            <div class="text-danger mt-1">
              @if (employeeId.errors?.['required']) {
                <small>Employee ID is required</small>
              }
              @if (employeeId.errors?.['pattern']) {
                <small>Employee ID must contain numbers only</small>
              }
            </div>
          }
        </div>

        <div class="col-md-3">
          <input
            type="text"
            class="form-control"
            placeholder="Full Name"
            [(ngModel)]="form.full_name"
            name="full_name"
            required
            #fullName="ngModel"
          />
          @if (fullName.invalid && fullName.touched) {
            <div class="text-danger mt-1">
              <small>Full Name is required</small>
            </div>
          }
        </div>

        <div class="col-md-3">
          <input
            type="email"
            class="form-control"
            placeholder="Email"
            [(ngModel)]="form.email"
            name="email"
            #email="ngModel"
            required
            email
          />

          @if (email.invalid && email.touched) {
            <div class="text-danger mt-1">
              @if (email.errors?.['required']) {
                <small>Email is required</small>
              }
              @if (email.errors?.['email']) {
                <small>Enter a valid email address</small>
              }
            </div>
          }
        </div>

        <div class="col-md-2">
          <input
            type="text"
            class="form-control"
            placeholder="Department"
            [(ngModel)]="form.department"
            name="department"
            required
            #department="ngModel"
          />
          @if (department.invalid && department.touched) {
            <div class="text-danger mt-1">
              <small>Department is required</small>
            </div>
          }
        </div>

        <div class="col-md-1 d-grid">
          <button type="submit" class="btn btn-primary" [disabled]="empForm.invalid">Add</button>
        </div>
      </div>
    </form>

    <!-- @if (errorMessage != '') {
      <div class="alert alert-danger mt-3">
        {{ errorMessage }}
      </div>
    } -->
  </div>

  <div class="card p-3">
    <!-- @if (employees.length == 0) {
      <div class="text-center p-4">No employees found.</div>
    } @else { -->
    <table class="table table-hover align-middle">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Department</th>
          <th class="text-end">Actions</th>
          <th>Attendance</th>
        </tr>
      </thead>

      <tbody>
        @for (emp of employees; track emp.id) {
          <tr>
            <td>{{ emp.employee_id }}</td>
            <td>{{ emp.full_name }}</td>
            <td>{{ emp.email }}</td>
            <td>{{ emp.department }}</td>
            <td class="text-end">
              <button class="btn btn-sm btn-danger" (click)="deleteEmployee(emp.id!)">
                Delete
              </button>
            </td>
            <td class="text-end">
              <button class="btn btn-sm btn-primary" (click)="getattandanceById(emp.id!)">
                View
              </button>
            </td>
          </tr>
        }
      </tbody>
    </table>
    <!-- } -->
  </div>
</div>


<div class="container mt-4">

  <h3 class="page-title">Attendance Management</h3>

  <div class="card p-4 mb-4">
    <form (ngSubmit)="markAttendance()">
      <div class="row g-3">

        <div class="col-md-4">
          <select title="32" class="form-select"
                  [(ngModel)]="attendance.employee_id"
                  name="employee_id"
                  required>
            <option value="">Select Employee</option>
            <option *ngFor="let emp of employees"
                    [value]="emp.id">
              {{ emp.full_name }}
            </option>
          </select>
        </div>

        <div class="col-md-4">
          <input title="da" type="date"
                 class="form-control"
                 [(ngModel)]="attendance.attendance_date"
                 name="attendance_date"
                 required>
        </div>

        <div class="col-md-3">
          <select title="dd" class="form-select"
                  [(ngModel)]="attendance.status"
                  name="status"
                  required>
            <option value="">Status</option>
            <option value="Present">Present</option>
            <option value="Absent">Absent</option>
          </select>
        </div>

        <div class="col-md-1 d-grid">
          <button type="submit" class="btn btn-primary">Mark</button>
        </div>

      </div>
    </form>
  </div>

</div>

